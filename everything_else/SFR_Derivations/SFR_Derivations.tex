\documentclass[a4paper,11pt]{article}
\usepackage{geometry}
\usepackage{amsmath}
\usepackage{amsfonts}

\usepackage{hyperref}
\hypersetup{
 bookmarks=true,                % show bookmarks bar?
 unicode=false,                 % non-Latin characters in Acrobat’s bookmarks
 pdftoolbar=true,               % show Acrobat’s toolbar?
 pdfmenubar=true,               % show Acrobat’s menu?
 pdffitwindow=false,            % window fit to page when opened
 pdfstartview={FitH},           % fits the width of the page to the window
 pdftitle={SFR derivations},    % title
 pdfauthor={Szil{\'a}rd Szalay},        % author
 pdfsubject={},       % subject of the document
 pdfcreator={pdflatex},         % creator of the document
 pdfproducer={vim},             % producer of the document
 pdfkeywords={SFR} {BCR}, % list of keywords
 pdfnewwindow=true,             % links in new window
 colorlinks=true,               % false: boxed links; true: colored links
 linktoc=page,                  % defines which part of an entry in the table of contents is made into a link
%%%%%%%%% colored links
 linkcolor=blue,                % color of internal links       (red)
 citecolor=blue,                % color of links to bibliography
 filecolor=magenta,             % color of file links
 urlcolor=blue                  % color of external links
}
%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage[inline]{showlabels}
\renewcommand{\showlabelfont}{\footnotesize\ttfamily\color{OliveGreen}}
%%%%%%%%%%%%%%%%%%%%%%%%


\newcommand{\ceil}[1]{\lceil #1 \rceil}


\begin{document}

\section{SFR-BCR}

Binary variables: $x_1,x_2,\dots,x_n\in\{0,1\}$, 
and let $X:=\sum_{i=1}^n x_i$, $2\leq k\in\mathbb{N}$, $l = \ceil{\log k}$

\subsection{SFR-BCR-1,2}
We have the $l+1$ auxiliary variables $y_0,y_1,\dots,y_{l-1},z\in\{0,1\}$.
(In the formulas, summations for $i,i' = 1,2,\dots,n$ and $j,j' = 0,1,\dots,l-1$ are understood.)

We have the functions
\begin{equation}
\label{eq:Ak}
A_k(X,y,z) = X - (k-2^l)z - (k+1)(1-z) - \sum_{j=0}^{l-1}2^jy_j.
\end{equation}
For the  two cases
(top/bottom = SFR-BCR-1/SFR-BCR-2),
after substituting and collecting the terms,
\begin{equation}
\label{eq:Ak12}
\left.\begin{aligned}
&A_k(X,y,z) \\
&A_{n-k}({n-X},y,z) 
\end{aligned}\right\}
= -(1\pm k) \pm \sum_i x_i - \sum_j 2^jy_j + (1+2^l)z.
\end{equation}
Then the squares are
\begin{equation}
\label{eq:Ak12sq}
\begin{split}
\left.\begin{aligned}
&A_k(X,y,z)^2 \\
&A_{n-k}({n-X},y,z)^2 
\end{aligned}\right\}
= (1\pm k)^2 \mp2(1\pm k)\sum_i x_i +2(1\pm k)\sum_j 2^jy_j -2(1\pm k)(1+2^l)z & \\
+ \sum_i\sum_{i'} x_ix_{i'} \mp2\sum_i\sum_j 2^jx_iy_j \pm2 (1+2^l)\sum_i zx_i & \\
+ \sum_j\sum_{j'} 2^{j+j'}y_jy_{j'} - 2(1+2^l)\sum_j z 2^jy_j & \\
+ (1+2^l)^2z^2. &
\end{split}
\end{equation}
Because $z\in\{0,1\}$, we have $z^2=z$, so we can join the two terms,
\begin{equation}
-2(1\pm k)(1+2^l)z + (1+2^l)^2z^2 = (1+2^l)(2^l\mp2k-1)z,
\end{equation}
so we end up with
\begin{equation}
\label{eq:alpha12}
\begin{split}
&\left.\begin{aligned}
&A_k(X,y,z)^2 \\
&A_{n-k}({n-X},y,z)^2 
\end{aligned}\right\} = \\
&\underbrace{(1\pm k)^2}_{\alpha} 
+ \underbrace{\mp 2(1\pm k)}_{\alpha^{b}} \sum_i x_i 
+ \sum_j \underbrace{(1\pm k)2^{j+1}}_{\alpha^{b_{a,1}}}y_j
+ \underbrace{(1+2^l)(2^l\mp2k-1)}_{\alpha^{b_{a,2}}}z \\
&+ \underbrace{1}_{\alpha^{bb}} \sum_{i,i'} x_ix_{i'} 
+ \sum_{i,j} \underbrace{\mp2^{j+1}}_{\alpha^{bb_{a,1}}}x_iy_j
+ \underbrace{\pm2(1+2^l)}_{\alpha^{bb_{a,2}}}\sum_i x_iz \\
&+ \sum_{j,j'} \underbrace{2^{j+j'}}_{\alpha^{b_ab_{a,1}}}y_jy_{j'}
+ \sum_j \underbrace{-(1+2^l)2^{j+1}}_{\alpha^{b_ab_{a,2}}} y_j z.
\end{split}
\end{equation}
The coefficients are
\begin{subequations}
\label{eq:BCR12alpha}
\begin{align}
\alpha &= (1\pm k)^2, \\
%
\alpha^{b} &= \mp 2(1\pm k), \\
\alpha^{b_{a,1}} &= (1\pm k)2^{j+1}, \\
\alpha^{b_{a,2}} &= (1+2^l)(2^l\mp2k-1), \\
%
\alpha^{bb} &= 1, \\
\alpha^{bb_{a,1}} &= \mp2^{j+1}, \\
\alpha^{bb_{a,2}} &= \pm2(1+2^l), \\
\alpha^{b_ab_{a,1}} &= 2^{j+j'}, \\
\alpha^{b_ab_{a,2}} &= -(1+2^l)2^{j+1}.
\end{align}
\end{subequations}


Dictionary: \\
$l\mapsto m-1$, ($l+1=m$ auxiliary variables),\\
$x_i\mapsto b_i$, \\
$y_j\mapsto b_{a_j}$ ,
($b_{\text{a},j}$ would be a better choice, $\text{a}$ is a label, $j$ is an index, they should be on the same level.
Also the indexing of the $\alpha^{\dots}$ coefficients could be made more expressive.)\\
$z\mapsto b_{a_m}$, ($b_{\text{a},m}$ would be better)\\
$k\mapsto c$.\\
Note that, in this case, the $j$ indices of the auxiliary bits have to be shifted, since they are ranging from $1$, not $0$.
(This is not the case in the next subsection.)



\subsection{SFR-BCR-3,4}
We have now the $l$ auxiliary variables $y_1,y_2,\dots,y_{l-1},z\in\{0,1\}$.
(In the formulas, summations for $i,i' = 1,2,\dots,n$ and $j,j' = 1,2,\dots,l-1$ are understood.)

We have the functions
\begin{equation}
\label{eq:Akp}
A'_k(X,y,z) = X - (k-2^l)z - (k+1)(1-z) - \sum_{j=1}^{l-1}2^jy_j.
\end{equation}
Note that, compared to \eqref{eq:Ak},
 the difference is only in the range of index $j$ of the sum in the last term.
For the  two cases
(top/bottom = SFR-BCR-3/SFR-BCR-4),
after substituting and collecting the terms,
\begin{equation}
\label{eq:Akp34}
\left.\begin{aligned}
&A'_k(X,y,z) \\
&A'_{n-k}({n-X},y,z) 
\end{aligned}\right\}
= -(1\pm k) \pm \sum_i x_i - \sum_j 2^jy_j + (1+2^l)z.
\end{equation}
(Again, although not written out explicitly, 
the difference is in the range of $j$ of the summation, c.f., \eqref{eq:Ak12})

We can obtain the $\alpha^{\dots}$ coefficients for BCR-3,4
from those of BCR-1,2.
Instead of taking the squares, $A_k(X,y,z)^2$ and $A_{n-k}(n-X,y,z)^2$,
for BCR-3,4 we have to take 
$\frac12 A'_k(X,y,z)\bigl(A'_k(X,y,z)-1\bigr)=\frac12\bigl(A'_k(X,y,z)^2-A'_k(X,y,z)\bigr)$ and
$\frac12 A'_{n-k}(n-X,y,z)\bigl(A'_{n-k}(n-X,y,z)-1\bigr)=\frac12\bigl(A'_{n-k}(n-X,y,z)^2-A'_{n-k}(n-X,y,z)\bigr)$,
so, to get the new $\alpha^{\dots}$ coefficients,
we have to substract the corresponding coefficients of $A'_k(X,y,z)$ and $A'_{n-k}(n-X,y,z)$
(these can be read off from \eqref{eq:Akp34})
from the old ones \eqref{eq:BCR12alpha}, and divide by $2$.
(And not to forget that the summations for $j$ run over a different range.)


\begin{subequations}
\label{eq:BCR34alpha}
\begin{align}
\alpha &=\frac12\Bigl((1\pm k)^2--(1\pm k) \Bigr)= \frac12(k^2\pm3k+2), \\
%
\alpha^{b} &= \frac12\Bigl(\mp 2(1\pm k)-\pm1\Bigr)= -k\mp\frac32, \\
\alpha^{b_{a,1}} &= \frac12\Bigl((1\pm k)2^{j+1}--2^j\Bigr)= (3\pm k)2^{j-1}, \\
\alpha^{b_{a,2}} &= \frac12\Bigl((1+2^l)(2^l\mp2k-1)-(1+2^l)\Bigr)= (1+2^l)(2^{l-1}\mp k-1), \\
%
\alpha^{bb} &= \frac12\bigl(1\bigr)= \frac12, \\
\alpha^{bb_{a,1}} &= \frac12\bigl(\mp2^{j+1}\bigr)= \mp2^j, \\
\alpha^{bb_{a,2}} &= \frac12\bigl(\pm2(1+2^l)\bigr)= \pm(1+2^l), \\
\alpha^{b_ab_{a,1}} &= \frac12\bigl(2^{j+j'}\bigr)= 2^{j+j'-1}, \\
\alpha^{b_ab_{a,2}} &= \frac12\bigl(-(1+2^l)2^{j+1}\bigr)= -(1+2^l)2^{j}.
\end{align}
\end{subequations}

Dictionary: \\
$l\mapsto m$, ($l=m$ auxiliary variables),\\
$x_i\mapsto b_i$, \\
$y_j\mapsto b_{a_j},$ 
($b_{\text{a},j}$ would be a better choice, $\text{a}$ is a label, $j$ is an index, they should be on the same level.
Also the indexing of the $\alpha^{\dots}$ coefficients could be made more expressive.)\\
$z\mapsto b_{a_m}$, ($b_{\text{a},m}$ would be better)\\
$k\mapsto c$.


\end{document}

